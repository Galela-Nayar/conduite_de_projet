<div class="trr" style="margin: 0px; padding: 0px;">
    <div class="cell container">
        <div class="header">
            <div class="couleur">
                <div *ngFor="let etiquette of etiquettes" class="etiquette">
                    <div style="height: 14px; font-size: 10px; border-radius: 15px; padding: 0px 4px;" 
                    [style.color]="getContrastColor(etiquette.color)" [style.background-color]="etiquette.color"
                    (mouseover)="showEtiquetteName($event, etiquette.name)" (mouseout)="hideEtiquetteName()">
                        {{ etiquette.name }}
                    </div>
                </div>
                <div *ngIf="isEtiquetteNameVisible" class="etiquette" [style.left.px]="etiquetteNameLeft" [style.top.px]="etiquetteNameTop">
                    {{ hoveredEtiquetteName }}
                </div>
            </div>
            <div class="settings-and-checkbox"  *ngIf="droitUtilisateurActuel != 'Visiteur'">
                <mat-icon style=" font-size: 20px;" (click)="openDialogSetting($event)">edit</mat-icon>
            </div>
        </div>
        <div class="contenu">
            <div style="margin-left: 10px;" *ngIf="!isEditingNom" (dblclick)="editNom()">
                {{ tache?.nom }}
            </div>
            <div *ngIf="isEditingNom">
                <textarea #textareaNom *ngIf="isEditingNom" [(ngModel)]="tache.nom" (blur)="updateTaskNom()" (input)="adjustTextareaNom($event)" ></textarea>
            </div>
        </div>
        
    </div>
    <div class="cell" style="display: flex; flex-direction: column; position: relative;" >
        <div style="position: absolute; top: 5px; right: 0;">
            <mat-icon *ngIf="droitUtilisateurActuel != 'Visiteur'" (click)="openDialogCollaborateurs($event)">more_vert</mat-icon>
        </div>
        <div style="padding: 0; margin: 0;" *ngFor="let membre of membreAttribue">
            <div style="display: flex; padding: 0; margin: 0; align-items: center; position: relative;"  (mouseenter)="showMiniUserProfile(membre, $event)" (mouseleave)="hideMiniUserProfile()">
                <img [src]="'http://localhost:8080/utilisateurs/img?id=' + membre['id']" class="miniature" />
                <h4 style="margin: 5px;">{{ membre.nom }}</h4><h4 style="margin: 5px;">{{ membre.prenom }}</h4>

            </div>
            <app-mini-user-profil [style.top.px]="mouseY" [style.left.px]="mouseX" style="position: fixed; z-index: 1;"
             *ngIf="showMiniUserProfil" [membre]="selectedMembre" [id]="id"
                       (mouseenter)="cancelHideMiniUserProfile()" 
                       (mouseleave)="hideMiniUserProfile()"></app-mini-user-profil>
        </div>
    </div>
    
    <div *ngIf="tache != null && tache != undefined" class="cell" style="display: flex; flex-direction: column; position: relative;" [ngClass]="{'bg-create':(
        tache?.dateLimite == null && !tache.statutTerminer),
     'bg-success': tache.statutTerminer,
      'bg-warning': !tache.statutTerminer  && tache?.dateLimite != null}">
      <div style="position: absolute; top: 5px; right: 5px;">
        <mat-checkbox *ngIf="droitUtilisateurActuel != 'Visiteur'"
            [checked]="tache.statutTerminer"
            (change)="swapStatut()"
          >
          </mat-checkbox>
        </div>
        {{ tache.statutTerminer ? 'Terminé' : tache.dateLimite != null ? 'En Cours' : 'Créer'}}
        
    </div>
    <div class="cell" *ngIf="!isEditingPriorite" (dblclick)="editPriorite()">
        {{ tache?.priorite }}
    </div>
    <div class="cell" *ngIf="isEditingPriorite">
        <textarea style="text-align: center;" #textareaPriorite *ngIf="isEditingPriorite" [(ngModel)]="tache.priorite" (blur)="updateTaskPriorite()" (input)="adjustTextareaPriorite($event)"></textarea>
    </div>
    <div class="cell" *ngIf="!isEditingPonderation" (dblclick)="editPonderation()">
        {{ tache?.ponderation }}
    </div>
    <div class="cell" *ngIf="isEditingPonderation">
        <textarea style="text-align: center;" #textareaPonderation *ngIf="isEditingPonderation" [(ngModel)]="tache.ponderation" (blur)="updateTaskPonderation()" (input)="adjustTextareaPonderation($event)"></textarea>
    </div>
    <div class="cell">
        {{ tache?.dateCreation | date }}
    </div>
    <div class="cell">
        {{ tache?.dateLimite | date }}
        <mat-icon *ngIf="droitUtilisateurActuel != 'Visiteur'" style="margin-left: 10px;" (click)="openDialog($event)">calendar_today</mat-icon>
    </div>
</div>